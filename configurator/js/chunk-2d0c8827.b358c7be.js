(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c8827"],{"54d6":function(e,t,s){"use strict";s.r(t);class r{constructor(e,t,s,r){this._outgoingMessageBus=null,this._execMessage=null,this._side=e,this._incomingMessageBus=t,this._outgoingMessageBus=s,this._execMessage=r,this._incomingMessageBus.addEventListener("message",this._handleMessage.bind(this))}setOutgoingMessageBus(e){this._outgoingMessageBus=e}setMessageExecution(e){this._execMessage=e}sendMessage(e,t=[]){return new Promise((s,r)=>{const i=new MessageChannel;i.port1.onmessage=e=>{if(!e||!e.data)return i.port1.close(),i.port2.close(),r(new Error(this._side+" received message but response can not be interpreted"));let t;try{t=JSON.parse(e.data)}catch(n){return i.port1.close(),i.port2.close(),this._prepareError(n),r(n)}t.error?r(t.error):void 0!==t.result?s(t.result):s(),i.port1.close(),i.port2.close()};let n="";try{n=JSON.stringify({message:e,args:t})}catch(o){return r(new Error(this._side+": can not create command because it is not JSON.stringify able"))}if(!this._outgoingMessageBus)return r(new Error(this._side+": outgoing bus not set yet"));this._outgoingMessageBus.postMessage(n,"*",[i.port2])})}_handleMessage(e){const t=e.ports&&Array.isArray(e.ports)&&e.ports.length>0?e.ports[0]:null;if(e.data&&t)try{const s=JSON.parse(e.data);if(!this._execMessage)return t.postMessage(JSON.stringify({error:this._side+" is not ready to handle messages"}));Array.isArray(s.args)||(s.args=[s.args]);const r=this._execMessage(s,e);if(void 0===r)return;r.then((e={})=>{let s=void 0,r=void 0;"object"===typeof e&&null!==e&&(s=e.error,r=e.result),s?t.postMessage(JSON.stringify({error:s})):void 0!==r?t.postMessage(JSON.stringify({result:r})):t.postMessage(JSON.stringify({result:e}))},e=>{t.postMessage(JSON.stringify({error:this._prepareError(e)}))})}catch(s){t.postMessage(JSON.stringify({error:this._prepareError(s)}))}}_prepareError(e){if("string"===typeof e){const t=this._side+": "+e;return console.error(t),t}return e.message=this._side+": "+e.message,console.error(e),e.message}}const i=".",n={REQUEST_BOOT:"requestBoot",SETUP:"setup",WEBSITE_READY:"websiteReady"},o=async(e,t)=>{if("string"!==typeof e)throw new Error('Configurator ID is not a string type: "'+typeof e+'"');const s=t.customApiUrl?t.customApiUrl:"https://api.roomle.com/v2",r=t.overrideTenant||9,i=s+"/configurators/"+e,n="roomle_portal_v2",o="03-"+window.btoa((new Date).toISOString()+";anonymous;"+n),a=()=>{const e={apiKey:n,currentTenant:r,locale:"en",language:"en",device:1,token:o,platform:"web"};return new Headers(e)},c=new Request(i,{method:"GET",headers:a(),mode:"cors",cache:"default"}),l=await fetch(c),{configurator:u}=await l.json();return u},a=()=>{try{return window.self!==window.top}catch(e){return!0}},c=(e,t)=>{const s=JSON.parse(JSON.stringify(e));return l(s,t)},l=(e,t)=>{for(const r in t)try{t[r].constructor===Object?e[r]=l(e[r],t[r]):e[r]=t[r]}catch(s){e[r]=t[r]}return e},u=["127.0.0.1","localhost","0.0.0.0"],d=()=>{const e=a();let t=window.location.href;if(e){if(!document.referrer)return null;t=document.referrer}const{hostname:s}=new URL(t);return s},h=e=>!!u.includes(e)||(!!e.endsWith("roomle.com")||!(!e.endsWith("gitlab.io")&&!e.endsWith("gitlab.com"))),g=["language","browserLanguage","userLanguage","systemLanguage"],m=(e=null)=>{const t=window.navigator;if(e)return e.substr(0,2);if(Array.isArray(t.languages)&&t.languages.length>0)return t.languages[0].substr(0,2);for(let s=0,r=g.length;s<r;s++){const e=t[g[s]];if(e)return e.substr(0,2)}return"en"},f="(idle)",_=e=>(p(e),(null===e||void 0===e?void 0:e.customApiUrl)&&(e.customApiUrl=decodeURIComponent(e.customApiUrl)),void 0===e.emails&&(e.emails=!1),e.shareUrl&&(e.deeplink=e.shareUrl.replace(O,E)),e),p=e=>{if(!e)return;const t=Object.keys(e);for(const s of t){const t=e[s];if(!Array.isArray(t)&&"object"===typeof t&&null!==t)return p(t);if(Array.isArray(t)){for(const e of t)p(e);return}"true"!==t&&"false"!==t||(e[s]="true"===t)}},w=(e,t)=>{t.configuratorId=e.id;const s=e.settings||{};return!t.overrideTenant&&e.tenant&&(t.overrideTenant=e.tenant),c(s,t)},y=()=>{const e={};e.locale||(e.locale=m()),e.id===f&&delete e.id;const t=d();return t&&h(t)&&(e.configuratorId="demoConfigurator"),e.customApiUrl="https://www.roomle.com/api/v2",e.emails=!1,e},O="<CONF_ID>",E="#CONFIGURATIONID#",v=()=>/(android)/i.test(navigator.userAgent),I=(e,t,s)=>{let r=null;Object.defineProperty(e,t,{get(){return r||s},set(e){(null===e||void 0===e?void 0:e.mute)?r=e.value:(console.warn("You override Roomle defined behaviour. To disalbe this warning pass in an object with the following properties"),console.warn("{ mute: true, value: () => void }"),r=e)}})},b=()=>.01*window.innerHeight+"px",N=e=>{e&&setTimeout(()=>e.style.setProperty(D,b()),0)},T="rml-styles",M=450,D="--rml-full-height",L={CONTAINER:"rml-container",FILL:"rml-fill",POSITION:"rml-pos",TRANSITION:"rml-transition",ANDROID_HEIGHT:"rml-android-height",OVERFLOW_HIDDEN:"rml-overflow-hidden"},R=new Map;class S{constructor(e,t,s,i){if(this.ui={callbacks:null},this.extended={callbacks:null},this.analytics={callbacks:{}},this._initData={},!e||"string"!==typeof e.id)throw new Error("Please provide a correct configuratorId, you get the correct ID from your Roomle Contact Person");if(R.has(t))throw new Error("There is already an instance on this DOM element");const n=!!document.getElementById(T);if(!n){const e=s.zIndex||9999999,t=document.createElement("style");t.type="text/css",t.id=T;const r="transition:all ease-in-out "+M+"ms;",i=["-webkit-","-o-"].reduce((e,t)=>e+(t+r),"")+r,n=b();t.innerHTML=`\n        .${L.CONTAINER}{${D}:${n};}\n        .${L.POSITION}{position:fixed;top:0;left:0;z-index:${e};opacity:0}\n        .${L.TRANSITION}{${i}}\n        .${L.FILL}{width:100%;height:100%;opacity:1}\n        .${L.ANDROID_HEIGHT}{height:calc(var(${D},1vh)*100)}\n        .${L.OVERFLOW_HIDDEN}{overflow:hidden}\n      `,document.head.appendChild(t)}this._onResize=this._onResize.bind(this),v()&&window.addEventListener("resize",this._onResize),this._container=t,this._initData=s,this._configuratorSettings=e;const o=this._createIframe();this._onUseFullPage=this._onUseFullPage.bind(this),this._executeMessage=this._executeMessage.bind(this),this._onBackToWebsite=this._onBackToWebsite.bind(this),this._messageHandler=new r("website",window,null,this._executeMessage),this._waitForIframe=i,this._container.appendChild(o),this._iframe=o,R.set(t,!0)}static createPlanner(e,t,s){return this._create(e,t,s)}static createConfigurator(e,t,s){return this._create(e,t,s)}static create(e,t,s){return this._create(e,t,s)}static createViewer(e,t,s){return this._create(e,t,s)}static _create(e,t,s){return new Promise(async(r,i)=>{try{const i=l(y(),_(s));i.featureFlags||(i.featureFlags={}),i.featureFlags.realPartList||(i.featureFlags.realPartList=!0);const n=await o(e,i);return s=w(n,i),new this(n,t,s,r)}catch(n){return i(n)}})}teardown(){this._container&&R.delete(this._container);const e=this._container.querySelector("iframe");e&&this._container.removeChild(e),window.removeEventListener("resize",this._onResize)}_createIframe(){var e;const t=document.createElement("iframe");let s=(null===(e=this._configuratorSettings)||void 0===e?void 0:e.url)||"https://www.roomle.com/t/cp/";return this._initData.useLocalRoomle&&(s=location.href.replace("embedding.html","")),location.href.includes("roomle.gitlab.io")&&(s=location.href.replace("embedding.html","index.html")),this._initData.overrideServerUrl&&(s=this._initData.overrideServerUrl),t.src=s,t.classList.add(L.CONTAINER),t.classList.add(L.FILL),t}_onResize(){N(this._iframe)}_onUseFullPage(){this._iframe.classList.add(L.POSITION),document.documentElement.classList.add(L.OVERFLOW_HIDDEN),window.document.body.classList.add(L.OVERFLOW_HIDDEN),v()&&(N(this._iframe),this._iframe.classList.add(L.ANDROID_HEIGHT))}_onBackToWebsite(){this._iframe.classList.remove(L.POSITION),this._iframe.classList.remove(L.ANDROID_HEIGHT),document.documentElement.classList.remove(L.OVERFLOW_HIDDEN),window.document.body.classList.remove(L.OVERFLOW_HIDDEN)}_executeMessage({message:e,args:t},s){var r;if(!s.source)return;if(s.source!==(null===(r=this._iframe)||void 0===r?void 0:r.contentWindow))return;if(e===n.REQUEST_BOOT)return this._messageHandler.setOutgoingMessageBus(s.source),Promise.resolve({result:this._initData});if(e===n.SETUP){const{methods:e,callbacks:s}=t[0];return e.forEach(e=>{const t=e.split(i),s=t[0],r=t[1];this[s][r]=function(){return this._messageHandler.sendMessage(e,[...arguments])}.bind(this)}),s.forEach(e=>{const t=e.split(i),s=t[0],r=t[1],n=t[2];this[s][r]||(this[s][r]={}),this[s][r][n]=()=>{}}),I(this.ui.callbacks,"onUseFullPage",this._onUseFullPage),I(this.ui.callbacks,"onBackToWebsite",this._onBackToWebsite),this._waitForIframe(this),setTimeout(()=>this._messageHandler.sendMessage(n.WEBSITE_READY),0),Promise.resolve({result:null})}const o=e.split(i),a=o[0],c=o[1],l=3===o.length?o[2]:null;return l&&this[a][c][l]?(this[a][c][l](...t),Promise.resolve({result:null})):Promise.reject('Message "'+e+'" is unkown')}}t["default"]=S}}]);
//# sourceMappingURL=chunk-2d0c8827.b358c7be.js.map