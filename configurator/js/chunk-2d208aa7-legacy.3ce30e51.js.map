{"version":3,"sources":["webpack:///./node_modules/@roomle/web-sdk/lib/dimensioning-helper-4df10850.js"],"names":["PLANE_MATERIAL","TEXT_MATERIAL","TextWithBackground","e","THREE","Object3D","super","this","_label","_parameters","font","size","height","curveSegments","bevelEnabled","bevelThickness","bevelSize","topDown","_position","Vector3","_initMaterials","_init","_update","_cacheHolder","materialCache","has","_planeMaterial","get","MeshBasicMaterial","color","side","DoubleSide","opacity","transparent","set","_textMaterial","MeshPhongMaterial","Geometry","_text","Mesh","name","_plane","_textGeometry","TextGeometry","computeBoundingBox","geometry","add","i","t","s","copy","_dimensioningType","_cameraPosition","n","distanceTo","position","h","Math","max","o","Quaternion","setFromAxisAngle","PI","_updateText","atan2","x","z","rotation","y","_getXSign","boundingBox","getSize","center","quaternion","PlaneGeometry","prototype","DimensioningHelper","_textUpdated","_topDimensions","_initialized","_enabled","_dimensionsVisible","_creator_","_lineMaterial","LineBasicMaterial","linewidth","_widthLine","Line","_heightLine","_depthLine","loadFont","then","_font","_loaded","update","addToScene","_scene","_uiScene","resolve","_lineBounds","_updateHeight","_updateWidth","_updateDepth","_getWidthEdge","vertices","push","start","end","dispose","getCenter","_widthText","_unitFormatter","formatMMValueToUnitString","_dimensions","_getHeightEdge","_heightText","_getDepthEdge","_depthText","clone","expandByScalar","_visibilityChangedCallback","_performUpdate","remove","Line3","min","_onChange","enableDimensions","visible","disableDimensions","removeFromScene","Box3","expandByObject","setVisibility","_clear","wait"],"mappings":"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","file":"js/chunk-2d208aa7-legacy.3ce30e51.js","sourcesContent":["import\"./query-params-helper-a271f9dc.js\";import{d as dispose,_ as __decorate,i as inject,y as AsyncGuard}from\"./rapi-access-413632b4.js\";import\"./main-thread-to-worker-8efc9a92.js\";import\"./image-renderer-d4f0305a.js\";import\"./pixotron-2f79bd46.js\";import{A as AsyncDependencyLoader,R as RUBIK_SUB_FILE_NAME}from\"./configurator-c1c1186e.js\";import\"./ui-callback-908e86fb.js\";import\"./configurator-mesh-generator-b9cff6c4.js\";import\"./default-light-setting-3329a5c3.js\";const PLANE_MATERIAL=\"component_dimensioning_plane_material\",TEXT_MATERIAL=\"component_dimensioning_text_material\";let TextWithBackground=(()=>{class e extends THREE.Object3D{constructor(e){super(),this._label=\"\",this._parameters={font:null,size:.1,height:.001,curveSegments:2,bevelEnabled:!0,bevelThickness:.001,bevelSize:.001},this.topDown=!1,this._parameters.font=e,this._position=new THREE.Vector3,this._initMaterials(),this._init(),this._update()}_initMaterials(){this._cacheHolder.materialCache.has(PLANE_MATERIAL)?this._planeMaterial=this._cacheHolder.materialCache.get(PLANE_MATERIAL):(this._planeMaterial=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,opacity:.8,transparent:!0}),this._cacheHolder.materialCache.set(PLANE_MATERIAL,this._planeMaterial)),this._cacheHolder.materialCache.has(TEXT_MATERIAL)?this._textMaterial=this._cacheHolder.materialCache.get(TEXT_MATERIAL):(this._textMaterial=new THREE.MeshPhongMaterial({color:3618615}),this._cacheHolder.materialCache.set(TEXT_MATERIAL,this._textMaterial))}_init(){let e=new THREE.Geometry;this._text=new THREE.Mesh(e,this._textMaterial),this._text.name=\"text with background text \"+this._label,this._plane=new THREE.Mesh(e,this._planeMaterial),this._plane.name=\"text with background plane \"+this._label,this._textGeometry=new THREE.TextGeometry(this._label,this._parameters),this._textGeometry.computeBoundingBox(),this._text.geometry=this._textGeometry,this.add(this._text),this.add(this._plane)}update(e,i,t,s){this._position.copy(e),this._dimensioningType=i,this._cameraPosition=s,this._label=t;const n=this._cameraPosition.distanceTo(this._text.position),h=Math.max(.01,n/100),o=Math.max(5e-4,n/5e3);this._parameters.bevelThickness=o,this._parameters.bevelSize=o,this._parameters.size=h,this._textGeometry=new THREE.TextGeometry(this._label,this._parameters),this._textGeometry.computeBoundingBox(),this._text.geometry=this._textGeometry,this._update()}_update(){if(this.topDown){let e=new THREE.Quaternion;e.setFromAxisAngle(new THREE.Vector3(-1,0,0),Math.PI/2),this._updateText(this._textGeometry,e,new THREE.Vector3)}else if(this._updateText(this._textGeometry,new THREE.Quaternion,new THREE.Vector3),this._cameraPosition){const e=Math.atan2(this._cameraPosition.x-this._position.x,this._cameraPosition.z-this._position.z);this._text.rotation.y=e,this._plane.rotation.y=e}}_updateText(e,i,t){let s=new THREE.Vector3;s.copy(this._position),t.x*=this._getXSign(),s.add(t);let n=e.boundingBox.getSize(new THREE.Vector3);e.center(),this._text.position.copy(s),this._text.quaternion.copy(i);let h=new THREE.PlaneGeometry(n.x+.02,n.y+.02,32);h.center(),this._plane.geometry=h,this._plane.position.copy(s),this._plane.quaternion.copy(i)}_getXSign(){return!this._cameraPosition||this._cameraPosition.x>=0?1:-1}dispose(){dispose(this)}}return __decorate([inject],e.prototype,\"_cacheHolder\",void 0),e})(),DimensioningHelper=(()=>{class e{constructor(e){this._cameraPosition=new THREE.Vector3,this._textUpdated=!1,this._topDimensions=!1,this._initialized=new AsyncGuard,this._enabled=!1,this._dimensionsVisible=!1,this._creator_=e,this._lineMaterial=new THREE.LineBasicMaterial({color:3618615,linewidth:2});let i=new THREE.Geometry;this._widthLine=new THREE.Line(i,this._lineMaterial),this._widthLine.name=\"dimension width line\",this._heightLine=new THREE.Line(i,this._lineMaterial),this._heightLine.name=\"dimension height line\",this._depthLine=new THREE.Line(i,this._lineMaterial),this._depthLine.name=\"dimension depth line\",this._planeMaterial=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide,opacity:.8,transparent:!0}),AsyncDependencyLoader.loadFont(RUBIK_SUB_FILE_NAME).then(e=>{this._font=e,this._loaded()})}_loaded(){this.update(!1),this.addToScene(this._scene,this._uiScene),this._initialized.resolve()}_performUpdate(e){this._enabled&&(this._lineBounds||e)&&this._font&&(this._updateHeight(),this._updateWidth(),this._updateDepth())}_updateWidth(){let e=new THREE.Geometry,i=this._getWidthEdge();e.vertices.push(i.start,i.end),this._widthLine.geometry.dispose(),this._widthLine.geometry=e;let t=i.getCenter(new THREE.Vector3);this._widthText||(this._widthText=new TextWithBackground(this._font)),this._widthText.topDown=this._topDimensions;const s=this._unitFormatter.formatMMValueToUnitString(1e3*this._dimensions.x);this._widthText.update(t,0,s,this._cameraPosition)}_updateHeight(){let e=new THREE.Geometry,i=this._getHeightEdge();e.vertices.push(i.start,i.end),this._heightLine.geometry.dispose(),this._heightLine.geometry=e;let t=i.getCenter(new THREE.Vector3);this._heightText||(this._heightText=new TextWithBackground(this._font)),this._heightText.topDown=this._topDimensions;const s=this._unitFormatter.formatMMValueToUnitString(1e3*this._dimensions.y);this._heightText.update(t,1,s,this._cameraPosition)}_updateDepth(){let e=new THREE.Geometry,i=this._getDepthEdge();e.vertices.push(i.start,i.end),this._depthLine.geometry.dispose(),this._depthLine.geometry=e;let t=i.getCenter(new THREE.Vector3);this._depthText||(this._depthText=new TextWithBackground(this._font)),this._depthText.topDown=this._topDimensions;const s=this._unitFormatter.formatMMValueToUnitString(1e3*this._dimensions.z);this._depthText.update(t,2,s,this._cameraPosition)}updateBounds(e){this._dimensions=e.getSize(new THREE.Vector3),this._lineBounds=e.clone(),this._lineBounds.expandByScalar(.05),this._textUpdated=!1,this.update()}update(e=!1){this._enabled&&!this._dimensionsVisible&&(this._dimensionsVisible=!0,this._visibilityChangedCallback()),this._performUpdate(e)}addToScene(e,i){this._widthText&&this._widthLine&&this._heightText&&this._heightLine&&this._heightText&&this._heightLine&&(e.add(this._widthLine),i.add(this._widthText),e.add(this._heightLine),i.add(this._heightText),e.add(this._depthLine),i.add(this._depthText))}removeFromScene(e,i){e.remove(this._widthLine),i.remove(this._widthText),e.remove(this._heightLine),i.remove(this._heightText),e.remove(this._depthLine),i.remove(this._depthText)}_getWidthEdge(){return this._cameraPosition.z>=0?new THREE.Line3(new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.max.z),new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.max.z)):new THREE.Line3(new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.min.z),new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.min.z))}_getDepthEdge(){return this._cameraPosition.x>=0?new THREE.Line3(new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.min.z),new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.max.z)):new THREE.Line3(new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.min.z),new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.max.z))}_getHeightEdge(){return this._cameraPosition.x>=0&&this._cameraPosition.z>=0?new THREE.Line3(new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.max.z),new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.max.y,this._lineBounds.max.z)):this._cameraPosition.x<0&&this._cameraPosition.z>=0?new THREE.Line3(new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.max.z),new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.max.y,this._lineBounds.max.z)):this._cameraPosition.x>=0&&this._cameraPosition.z<0?new THREE.Line3(new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.min.y,this._lineBounds.min.z),new THREE.Vector3(this._lineBounds.max.x,this._lineBounds.max.y,this._lineBounds.min.z)):new THREE.Line3(new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.min.y,this._lineBounds.min.z),new THREE.Vector3(this._lineBounds.min.x,this._lineBounds.max.y,this._lineBounds.min.z))}onDimensionsVisibilityChanged(e){this._onChange=e}enableTopDimensions(){this.enableDimensions(),this._topDimensions=!0,this._heightLine.visible=!1,this._heightText.visible=!1,this.update(!0)}disableTopDimensions(){this._topDimensions=!1,this._heightLine.visible=!0,this._heightText.visible=!0,this.disableDimensions()}enableDimensions(){this._enabled=!0,this.update(!0),this.addToScene(this._scene,this._uiScene)}disableDimensions(){this._enabled=!1,this._dimensionsVisible&&(this._dimensionsVisible=!1,this._visibilityChangedCallback()),this.removeFromScene(this._scene,this._uiScene)}_visibilityChangedCallback(){this._onChange&&this._onChange(this._dimensionsVisible)}_clear(){this._lineMaterial.dispose(),this._planeMaterial.dispose(),this._widthLine.geometry.dispose(),this._heightLine.geometry.dispose(),this._depthLine.geometry.dispose(),this._heightText.dispose(),this._heightText.dispose(),this._depthText.dispose()}getBoundingBox(){const e=new THREE.Box3;return e.expandByObject(this._widthLine),e.expandByObject(this._widthText),e.expandByObject(this._heightLine),e.expandByObject(this._heightText),e.expandByObject(this._depthLine),e.expandByObject(this._depthText),e}setVisibility(e){this._heightLine&&this._widthLine&&this._depthLine&&this._heightText&&this._widthText&&this._depthText&&(this._heightLine.visible=e,this._heightText.visible=e,this._widthLine.visible=e,this._widthText.visible=e,this._depthLine.visible=e,this._depthText.visible=e)}moveCameraStart(e){this.setVisibility(!1),this._cameraPosition=e,this.update()}moveCameraEnd(e){this.setVisibility(!0),this._cameraPosition=e,this.update()}clearScene(e){this._clear()}setScene(e){this._scene=e}setUiScene(e){this._uiScene=e}needsUiScene(){return!0}isInitialized(){return this._initialized.wait()}areDimensionsEnabled(){return this._enabled}}return __decorate([inject],e.prototype,\"_unitFormatter\",void 0),e})();export default DimensioningHelper;\n//# sourceMappingURL=dimensioning-helper-4df10850.js.map\n"],"sourceRoot":""}